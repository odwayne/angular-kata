angular.module("collection",[]).factory("IndexedCollection",[function(){var e=function(e){this.items=e||[]};return e.prototype.isEmpty=function(){return 0===this.size()},e.prototype.size=function(){return this.items.length},e.prototype.add=function(e){this.items.push(e)},e.prototype.getAt=function(e){return this.items[e]},e.prototype.getNext=function(e){var t=this.items.indexOf(e)+1;return this.getAt(t)},e.prototype.getPrevious=function(e){var t=this.items.indexOf(e)-1;return this.getAt(t)},e.prototype.getLast=function(){return this.getAt(this.size()-1)},e.prototype.haveNext=function(e){return this.items.indexOf(e)+1<this.size()},e.prototype.havePrevious=function(e){return this.items.indexOf(e)>0},e}]),describe("The Indexed Collection",function(){var e,t;beforeEach(module("collection")),beforeEach(inject(function(i){e=new i(["value1","value2","value3"]),t=new i})),it("should get the next element",function(){var t=e.getAt(0),i=e.getAt(1);expect(e.getPrevious(i)).toBe(t)})});var CollectionDemoCtrl=function(e,t){e.items=new t(["item1","item2"]).items};describe("The Wizard Module",function(){beforeEach(module("wizard")),describe("The Wizard Directive",function(){var e,t,i,n;beforeEach(module("template/wizard/wizard.html")),beforeEach(module("template/wizard/pane.html")),beforeEach(module("wizard")),beforeEach(inject(function(a,o){e=angular.element('<wizard><pane heading="Step 1">Content 1</pane><pane heading="Step 2">Content 2</pane></wizard>'),t=o,a(e)(t),t.$digest(),i=e.find("ul.steps li a"),n=e.find("div.panes .pane")})),it('should be a element with "wizard" class',function(){expect(e).toHaveClass("wizard")}),it("should create clickable steps with their heading text in the navigation",function(){expect(i.length).toBe(2),expect(i.eq(0).text()).toBe("Step 1"),expect(i.eq(1).text()).toBe("Step 2")}),it("should bind the content",function(){expect(n.length).toBe(2),expect(n.eq(0).text()).toBe("Content 1"),expect(n.eq(1).text()).toBe("Content 2")}),it("shoud activate the first step",function(){expect(i.parent().eq(0)).toHaveClass("active"),expect(n.eq(0)).toHaveClass("active"),expect(i.parent().eq(1)).not.toHaveClass("active"),expect(n.eq(1)).not.toHaveClass("active")}),it("should activate the next step",function(){e.find(".btn-next").click(),expect(i.parent().eq(1)).toHaveClass("active"),expect(n.eq(1)).toHaveClass("active"),expect(i.parent().eq(0)).toHaveClass("complete"),expect(n.eq(0)).toHaveClass("complete")}),it("should activate the prev step",function(){e.find(".btn-next").click(),e.find(".btn-prev").click(),expect(i.parent().eq(0)).toHaveClass("active"),expect(n.eq(0)).toHaveClass("active"),expect(i.parent().eq(1)).not.toHaveClass("active"),expect(n.eq(1)).not.toHaveClass("active")})}),describe("The Wizard Controller",function(){var e,t,i;beforeEach(inject(function(n,a,o){e=n("WizardCtrl",{$scope:t=a}),i=new o,e.addStep(i)})),it("shoud add a child step scope to the wizardScope",inject(function(){expect(t.steps).toBeDefined(),expect(t.steps.length).toBe(1)})),it("should set the first step as active",function(){expect(i.status).toBe("active")}),it("should advance to next step",inject(function(t){var n=new t;e.addStep(n),e.nextStep(),expect(i.status).toBe("complete"),expect(n.status).toBe("active")})),it("should back to previous step",inject(function(t){var i=new t,n=new t;e.addStep(i),e.addStep(n),e.nextStep(),e.nextStep(),expect(i.status).toBe("complete"),expect(n.status).toBe("active"),e.prevStep(),expect(i.status).toBe("active"),expect(n.status).toBeUndefined()}))}),describe("The Step Factory",function(){var e;beforeEach(inject(function(t){e=new t("Heading One")})),it("should have a heading",function(){expect(e.heading).toBe("Heading One")}),it("should be initialized with undefined status",function(){expect(e.status).toBeUndefined()}),it("should became active",function(){e.activate(),expect(e.status).toBe("active")}),it("should became complete",function(){e.complete(),expect(e.status).toBe("complete")}),it("should revert his status",function(){e.activate(),e.reset(),expect(e.status).toBeUndefined(),e.complete(),e.activate(),expect(e.status).toBe("active")})})}),angular.module("wizard",["collection"]).factory("Step",[function(){var e=function(e){this.status=void 0,this.heading=e};return e.prototype.activate=function(){this.status="active"},e.prototype.reset=function(){this.status=void 0},e.prototype.complete=function(){this.status="complete"},e}]).directive("pane",["Step",function(e){return{restrict:"E",replace:!0,require:"^wizard",templateUrl:"template/wizard/pane.html",transclude:!0,scope:{heading:"@"},link:function(t,i,n,a){t.step=new e(t.heading),t.$watch("heading",function(e){t.step.heading=e}),a.addStep(t.step)}}}]).controller("WizardCtrl",["$scope","IndexedCollection",function(e,t){function i(){s.reset()}function n(){s.complete()}function a(){c(p.getNext(s))}function o(){c(p.getPrevious(s))}function c(e){s=e,s.activate()}var s,p=new t;this.nextStep=function(){p.haveNext(s)&&(n(),a())},this.prevStep=function(){p.havePrevious(s)&&(i(),o())},this.addStep=function(e){p.isEmpty()&&c(e),p.add(e)},e.steps=p.items,e.nextStep=this.nextStep,e.prevStep=this.prevStep}]).directive("wizard",[function(){return{restrict:"E",controller:"WizardCtrl",replace:!0,templateUrl:"template/wizard/wizard.html",scope:{},transclude:!0}}]),angular.module("template/wizard/pane.html",[]).run(["$templateCache",function(e){e.put("template/wizard/pane.html","<div class='pane' ng-class='step.status' ng-transclude></step>")}]),angular.module("template/wizard/wizard.html",[]).run(["$templateCache",function(e){e.put("template/wizard/wizard.html",'<div class="wizard">					<ul class="steps">		<li ng-repeat="step in steps" ng-class=\'step.status\'>			<a ng-bind="step.heading"></a>		</li>			</ul>		<div class="actions">		<button class="btn btn-mini btn-prev" ng-click="prevStep()">   			<i class="icon-arrow-left"></i>Prev		</button>		<button class="btn btn-mini btn-next" data-last="Finish" ng-click="nextStep()">			Next<i class="icon-arrow-right"></i>		</button>	</div>	<div class="panes" ng-transclude></div>	</div>')}]);